from consumer_producer import Consumer, Producer
from random import randint
from nose.tools import assert_equals

TESTTOPIC = "testingTopic"
TESTHOST = "10.69.22.152"
TESTGROUP = "testGroup"

def test_produce_consume():
    print("in test_produce_consume")
    p = Producer(TESTHOST)
    message = str(randint(0,100000))
    c = Consumer(TESTHOST, TESTGROUP, TESTTOPIC)
    c.getConsumer().seek(0,2) # skip all pending messages and start reading only new messages
    p.produce(TESTTOPIC, message)
    m = c.consume()
    assert_equals(m[1][3], message)
    
